"use strict";angular.module("highcharts-ng",[]).directive("highchart",function(){function i(i,n,r){var t=i[n];i[n]=function(){var i=Array.prototype.slice.call(arguments);r.apply(this,i);if(t){return t.apply(this,i)}else{return}}}function n(i,r){for(var t in r){if(r[t]&&r[t].constructor&&r[t].constructor===Object){i[t]=i[t]||{};n(i[t],r[t])}else{i[t]=r[t]}}return i}var r=0;var t=function(i){i.forEach(function(i){if(!angular.isDefined(i.id)){i.id="series-"+r++}})};var e={chart:{events:{}},title:{},series:[],navigator:{enabled:false}};var a=function(r,t,a){var c={};if(a.options){c=n(e,a.options)}else{c=e}c.chart.renderTo=t[0];if(r.config.xAxis){i(c.chart.events,"selection",function(i){var n=this;if(i.xAxis){r.$apply(function(){r.config.xAxis.currentMin=i.xAxis[0].min;r.config.xAxis.currentMax=i.xAxis[0].max})}else{r.$apply(function(){r.config.xAxis.currentMin=n.xAxis[0].dataMin;r.config.xAxis.currentMax=n.xAxis[0].dataMax})}});i(c.chart.events,"addSeries",function(i){r.config.xAxis.currentMin=this.xAxis[0].min||r.config.xAxis.currentMin;r.config.xAxis.currentMax=this.xAxis[0].max||r.config.xAxis.currentMax})}if(a.xAxis){c.xAxis=angular.copy(a.xAxis)}if(a.title){c.title=a.title}return c};var c=function(i,n){var r=i.getExtremes();if(n.currentMin!==r.dataMin||n.currentMax!==r.dataMax){i.setExtremes(n.currentMin,n.currentMax,false)}};var s=function(i,n){if(n.currentMin||n.currentMax){i.xAxis[0].setExtremes(n.currentMin,n.currentMax,true)}};var o=function(i,n){var r=[];if(n){t(n);n.forEach(function(n){r.push(n.id);var t=i.get(n.id);if(t){t.update(angular.copy(n),false)}else{i.addSeries(angular.copy(n),false)}})}i.series.forEach(function(i){if(r.indexOf(i.options.id)<0){i.remove(false)}})};var f=function(i,n,r){var t=a(i,n,r);var e=new Highcharts.Chart(t);if(r.xAxis){s(e,r.xAxis)}o(e,r.series);e.redraw();return e};return{restrict:"EC",replace:true,template:"<div></div>",scope:{config:"="},link:function(i,n,r){var t=f(i,n,i.config);i.$watch("config.series",function(i,n){if(i===n)return;o(t,i);t.redraw()},true);i.$watch("config.title",function(i){t.setTitle(i,true)},true);i.$watch("config.loading",function(i){if(i===false){t.hideLoading()}else{t.showLoading()}},true);i.$watch("config.xAxis",function(i,n){if(i===n)return;if(i){t.xAxis[0].update(i);c(t.xAxis[0],angular.copy(i));t.redraw()}},true);i.$watch("config.options",function(i,r,e){if(i===r)return;t.destroy();t=f(e,n,e.config)},true)}}});